# Robust Patcher - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è AI

## –ö—Ä–∞—Ç–∫–∏–π –æ–±–∑–æ—Ä

Robust Patcher - —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞—Ç—á–µ–π –∫ —Ñ–∞–π–ª–∞–º. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–æ–≤–æ–π –±–∞–∑–µ.

**API Endpoint:** `POST http://localhost:8080/api/patch/apply`

---

## –§–æ—Ä–º–∞—Ç –ø–∞—Ç—á–∞

```
=== PATCH START ===
NAME: –ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ç—á–∞
DESCRIPTION: –û–ø–∏—Å–∞–Ω–∏–µ
AUTHOR: –ê–≤—Ç–æ—Ä
VERSION: 1.0
---

--- FILE: –ø—É—Ç—å/–∫/—Ñ–∞–π–ª—É.ext ---
ACTION: —Ç–∏–ø_–¥–µ–π—Å—Ç–≤–∏—è
DESCRIPTION: –ß—Ç–æ –¥–µ–ª–∞–µ—Ç

<<< –ë–õ–û–ö_–¢–ò–ü
—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±–ª–æ–∫–∞
–ë–õ–û–ö_–¢–ò–ü >>>

=== PATCH END ===
```

---

## 8 —Ç–∏–ø–æ–≤ –¥–µ–π—Å—Ç–≤–∏–π

### 1. REPLACE - –∑–∞–º–µ–Ω–∞ –±–ª–æ–∫–∞ –∫–æ–¥–∞
```
ACTION: replace
<<< FIND
—Å—Ç–∞—Ä—ã–π –∫–æ–¥
FIND >>>
<<< REPLACE
–Ω–æ–≤—ã–π –∫–æ–¥
REPLACE >>>
```

### 2. INSERT_BEFORE - –≤—Å—Ç–∞–≤–∫–∞ –ø–µ—Ä–µ–¥ –º–∞—Ä–∫–µ—Ä–æ–º
```
ACTION: insert_before
<<< MARKER
–º–∞—Ä–∫–µ—Ä –≤ —Ñ–∞–π–ª–µ
MARKER >>>
<<< CONTENT
–Ω–æ–≤—ã–π –∫–æ–¥
CONTENT >>>
```

### 3. INSERT_AFTER - –≤—Å—Ç–∞–≤–∫–∞ –ø–æ—Å–ª–µ –º–∞—Ä–∫–µ—Ä–∞
```
ACTION: insert_after
<<< MARKER
–º–∞—Ä–∫–µ—Ä –≤ —Ñ–∞–π–ª–µ
MARKER >>>
<<< CONTENT
–Ω–æ–≤—ã–π –∫–æ–¥
CONTENT >>>
```

### 4. DELETE - —É–¥–∞–ª–µ–Ω–∏–µ –±–ª–æ–∫–∞
```
ACTION: delete
<<< FIND
–∫–æ–¥ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
FIND >>>
```

### 5. CREATE_FILE - —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
```
ACTION: create_file
<<< CONTENT
—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
CONTENT >>>
```

### 6. REPLACE_FILE - –ø–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–∞
```
ACTION: replace_file
<<< CONTENT
–Ω–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
CONTENT >>>
```
‚ö†Ô∏è –§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å! –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π CREATE_FILE.

### 7. DELETE_FILE - —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
```
ACTION: delete_file
<<< CONFIRM
true
CONFIRM >>>
```
üî¥ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è CONFIRM: true

### 8. MOVE_FILE - –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ/–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
```
ACTION: move_file
<<< TO
–Ω–æ–≤—ã–π/–ø—É—Ç—å/—Ñ–∞–π–ª–∞.ext
TO >>>
<<< OVERWRITE
false
OVERWRITE >>>
```

---

## –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è AI

### ‚úÖ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:

1. **–¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ** - –±–ª–æ–∫–∏ FIND/MARKER –¥–æ–ª–∂–Ω—ã –¢–û–ß–ù–û —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ñ–∞–π–ª–æ–º (–ø—Ä–æ–±–µ–ª—ã, –æ—Ç—Å—Ç—É–ø—ã)
2. **–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã** - –∏—Å–ø–æ–ª—å–∑—É–π –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª–∏–Ω–Ω—ã–µ –±–ª–æ–∫–∏ –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
3. **CONFIRM –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è** - –≤—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–π `CONFIRM: true` –¥–ª—è delete_file
4. **–ü–æ–ª–Ω—ã–µ –ø—É—Ç–∏** - —É–∫–∞–∑—ã–≤–∞–π –ø–æ–ª–Ω—ã–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º –æ—Ç –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
5. **–û–ø–∏—Å–∞–Ω–∏—è** - –¥–æ–±–∞–≤–ª—è–π –ø–æ–Ω—è—Ç–Ω—ã–µ DESCRIPTION –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è

### ‚ö†Ô∏è –ß–ê–°–¢–´–ï –û–®–ò–ë–ö–ò:

‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã –≤ FIND**
```
<<< FIND
function test(){  // –ë–ï–ó –ø—Ä–æ–±–µ–ª–∞
FIND >>>
```

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```
<<< FIND
function test() {  // –° –ø—Ä–æ–±–µ–ª–æ–º –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ
FIND >>>
```

‚ùå **–°–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π –º–∞—Ä–∫–µ—Ä**
```
<<< MARKER
{
MARKER >>>
```

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```
<<< MARKER
    companion object {
        const val VERSION = "1.0"
MARKER >>>
```

‚ùå **–ó–∞–±—ã–ª CONFIRM**
```
ACTION: delete_file
```

‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```
ACTION: delete_file
<<< CONFIRM
true
CONFIRM >>>
```

### üéØ –ö–û–ì–î–ê –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ –ö–ê–ö–û–ô ACTION:

| –ó–∞–¥–∞—á–∞ | Action |
|--------|--------|
| –ò–∑–º–µ–Ω–∏—Ç—å —á–∞—Å—Ç—å —Ñ–∞–π–ª–∞ | `replace` |
| –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ –≤ –Ω–∞—á–∞–ª–æ/–∫–æ–Ω–µ—Ü –±–ª–æ–∫–∞ | `insert_before` / `insert_after` |
| –£–¥–∞–ª–∏—Ç—å –±–ª–æ–∫ –∫–æ–¥–∞ | `delete` |
| –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª | `create_file` |
| –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –≤–µ—Å—å —Ñ–∞–π–ª | `replace_file` |
| –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª | `delete_file` |
| –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Ñ–∞–π–ª | `move_file` |

### üí° –°–û–í–ï–¢–´:

1. **–î–ª—è –±–æ–ª—å—à–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π** - –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `replace_file` —á–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–æ `replace`
2. **–ü–æ—Ä—è–¥–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π**:
   - –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–≤–∞–π —Ñ–∞–π–ª—ã (`create_file`)
   - –ü–æ—Ç–æ–º –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π (`replace`, `insert_*`)
   - –í –∫–æ–Ω—Ü–µ —É–¥–∞–ª—è–π (`delete_file`)
3. **–ì—Ä—É–ø–ø–∏—Ä—É–π —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** –≤ –æ–¥–∏–Ω –ø–∞—Ç—á
4. **–ò—Å–ø–æ–ª—å–∑—É–π dry-run** - –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `dryRun: true`

---

## –ë—ã—Å—Ç—Ä—ã–π —à–∞–±–ª–æ–Ω

```
=== PATCH START ===
NAME: –ö—Ä–∞—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
DESCRIPTION: –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø–∞—Ç—á
AUTHOR: AI Assistant
VERSION: 1.0
---

--- FILE: –ø–æ–ª–Ω—ã–π/–ø—É—Ç—å/–∫/—Ñ–∞–π–ª—É.ext ---
ACTION: —Ç–∏–ø_–¥–µ–π—Å—Ç–≤–∏—è
DESCRIPTION: –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å —ç—Ç–∏–º —Ñ–∞–π–ª–æ–º

<<< –ë–õ–û–ö
—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
–ë–õ–û–ö >>>

=== PATCH END ===
```

---

## –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

### –î–æ–±–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç
```
--- FILE: src/Main.kt ---
ACTION: insert_after
DESCRIPTION: Add logging import

<<< MARKER
package com.example
MARKER >>>

<<< CONTENT

import org.slf4j.LoggerFactory
CONTENT >>>
```

### –ó–∞–º–µ–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é
```
--- FILE: src/Utils.kt ---
ACTION: replace
DESCRIPTION: Update helper function

<<< FIND
fun helper(x: Int): Int {
    return x * 2
}
FIND >>>

<<< REPLACE
fun helper(x: Int, multiplier: Int = 2): Int {
    return x * multiplier
}
REPLACE >>>
```

### –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥
```
--- FILE: config/settings.json ---
ACTION: create_file
DESCRIPTION: Create configuration file

<<< CONTENT
{
  "version": "1.0",
  "enabled": true
}
CONTENT >>>
```

### –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Ñ–∞–π–ª
```
--- FILE: old/location/File.kt ---
ACTION: move_file
DESCRIPTION: Move to new package

<<< TO
new/location/File.kt
TO >>>

<<< OVERWRITE
false
OVERWRITE >>>
```

---

## –°—Ç–∞—Ç—É—Å—ã –æ—Ç–≤–µ—Ç–∞

- **SUCCESS** - –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ ‚úÖ
- **SKIPPED** - –ø—Ä–æ–ø—É—â–µ–Ω–æ (–±–ª–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω, —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç) ‚è≠Ô∏è
- **FAILED** - –æ—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è ‚ùå
- **FILE_NOT_FOUND** - —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω üîç

---

## –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –ø–∞—Ç—á–∞

- [ ] –í—Å–µ –ø—É—Ç–∏ —É–∫–∞–∑–∞–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
- [ ] –ë–ª–æ–∫–∏ FIND/MARKER —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã —Ç–æ—á–Ω–æ –∏–∑ —Ñ–∞–π–ª–∞
- [ ] –î–æ–±–∞–≤–ª–µ–Ω CONFIRM: true –¥–ª—è delete_file
- [ ] –î–æ–±–∞–≤–ª–µ–Ω—ã DESCRIPTION –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] –í—ã–±—Ä–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø ACTION –¥–ª—è –∑–∞–¥–∞—á–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –º–∞—Ä–∫–µ—Ä–æ–≤
- [ ] –ü–∞—Ç—á –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `=== PATCH START ===`
- [ ] –ü–∞—Ç—á –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è `=== PATCH END ===`

---

## –¢–∏–ø–∏—á–Ω—ã–π workflow

1. **–°–æ–∑–¥–∞–π –ø–∞—Ç—á** —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
2. **–ü—Ä–æ–≤–µ—Ä—å** —á–µ—Ä–µ–∑ `/api/patch/validate`
3. **–¢–µ—Å—Ç–∏—Ä—É–π** —Å `dryRun: true`
4. **–ü—Ä–∏–º–µ–Ω—è–π** —Å `dryRun: false`

---

**–ü–æ–º–Ω–∏:** –¢–æ—á–Ω–æ—Å—Ç—å - –∫–ª—é—á –∫ —É—Å–ø–µ—Ö—É! –û–¥–∏–Ω –ª–∏—à–Ω–∏–π –ø—Ä–æ–±–µ–ª = SKIPPED —Å—Ç–∞—Ç—É—Å.